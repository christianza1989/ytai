{% extends "base.html" %}

{% block content %}
<div class="grid">
    <!-- API Configuration Status -->
    <div class="card">
        <h2>ğŸ”‘ API KonfigÅ«racija</h2>
        <div style="margin: 1rem 0;">
            <p><span class="status-indicator {% if config.suno_api %}status-ok{% else %}status-error{% endif %}"></span>
               Suno API: {% if config.suno_api %}SukonfigÅ«ruota{% else %}NesukonfigÅ«ruota{% endif %}</p>
            
            <p><span class="status-indicator {% if config.gemini_api %}status-ok{% else %}status-error{% endif %}"></span>
               Gemini AI: {% if config.gemini_api %}SukonfigÅ«ruota{% else %}NesukonfigÅ«ruota{% endif %}</p>
            
            <p><span class="status-indicator status-ok"></span>
               ğŸŒ Nano-Banana: Naudoja Gemini API raktÄ…</p>
        </div>
        
        {% if not (config.suno_api and config.gemini_api) %}
        <div class="alert alert-warning">
            <strong>âš ï¸ Ä®spÄ—jimas:</strong> Ne visi API raktai sukonfigÅ«ruoti. 
            Redaguokite <code>.env</code> failÄ…, kad pridÄ—tumÄ—te trÅ«kstamus raktus.
        </div>
        {% endif %}
    </div>
    
    <!-- Generation Controls -->
    <div class="card">
        <h2>ğŸµ Muzikos Generavimas</h2>
        
        {% if generation_status.running %}
            <div class="alert alert-warning">
                <strong>ğŸ”„ Generavimas vyksta...</strong><br>
                Dabartinis Å¾ingsnis: {{ generation_status.current_step }}<br>
                <a href="/status" class="btn btn-secondary">PerÅ¾iÅ«rÄ—ti ProgresÄ…</a>
            </div>
        {% else %}
            <form method="POST" action="/generate">
                <div class="form-group">
                    <label for="mode">Generavimo ReÅ¾imas:</label>
                    <select name="mode" class="form-control" required>
                        <option value="mock">ğŸ§ª Testavimo reÅ¾imas (Mock duomenys)</option>
                        {% if config.suno_api and config.gemini_api %}
                        <option value="real">ğŸ”‘ Realus reÅ¾imas (API raktai)</option>
                        {% endif %}
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="genre">Å½anras:</label>
                    <select name="genre" class="form-control" required>
                        <option value="Lo-Fi Hip Hop">Lo-Fi Hip Hop</option>
                        <option value="Ambient">Ambient</option>
                        <option value="Chill Hop">Chill Hop</option>
                        <option value="Synthwave">Synthwave</option>
                        <option value="Jazz">Jazz</option>
                        <option value="Electronic">Electronic</option>
                        <option value="Classical">Classical</option>
                        <option value="Rock">Rock</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="theme">Tema/Nuotaika:</label>
                    <input type="text" name="theme" class="form-control" 
                           placeholder="PavyzdÅ¾iui: rainy night in Tokyo" 
                           value="rainy night in Tokyo" required>
                </div>
                
                <button type="submit" class="btn">ğŸš€ PradÄ—ti GeneravimÄ…</button>
            </form>
        {% endif %}
    </div>
</div>

<!-- Recent Outputs -->
{% if recent_outputs %}
<div class="card">
    <h2>ğŸ“‚ Paskutiniai Rezultatai</h2>
    <div class="grid">
        {% for output in recent_outputs %}
        <div class="card">
            <h3>ğŸµ {{ output.metadata.title or output.name }}</h3>
            <p><strong>Sukurta:</strong> 
               {% if output.metadata.created_at %}
                   {{ output.metadata.created_at[:19] | replace('T', ' ') }}
               {% else %}
                   NeÅ¾inoma
               {% endif %}
            </p>
            {% if output.metadata.genre %}
            <p><strong>Å½anras:</strong> {{ output.metadata.genre }}</p>
            {% endif %}
            {% if output.metadata.tracks_created %}
            <p><strong>Takeliai:</strong> {{ output.metadata.tracks_created }}</p>
            {% endif %}
            <a href="/outputs" class="btn btn-secondary">PerÅ¾iÅ«rÄ—ti</a>
        </div>
        {% endfor %}
    </div>
    <div style="text-align: center; margin-top: 1rem;">
        <a href="/outputs" class="btn btn-secondary">PerÅ¾iÅ«rÄ—ti Visus Rezultatus</a>
    </div>
</div>
{% endif %}

<!-- Quick Actions -->
<div class="card">
    <h2>âš¡ Greitieji Veiksmai</h2>
    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
        <a href="/status" class="btn btn-secondary">ğŸ“Š PerÅ¾iÅ«rÄ—ti BÅ«senÄ…</a>
        <a href="/outputs" class="btn btn-secondary">ğŸ“‚ Visi Rezultatai</a>
        <button onclick="window.location.reload()" class="btn btn-warning">ğŸ”„ Atnaujinti PuslapÄ¯</button>
    </div>
</div>

<!-- Instructions -->
<div class="card">
    <h2>ğŸ“– Instrukcijos</h2>
    <div style="line-height: 1.6;">
        <h3>ğŸ§ª Testavimo ReÅ¾imas</h3>
        <p>Naudoja mock duomenis testavimui. Nereikia API raktÅ³. Puikus pradÅ¾iai!</p>
        
        {% if config.suno_api and config.gemini_api %}
        <h3>ğŸ”‘ Realus ReÅ¾imas</h3>
        <p>Naudoja tikrus API raktus muzikos ir teksto generavimui. <strong>Naudoja kreditus!</strong></p>
        {% else %}
        <h3>ğŸ”§ API KonfigÅ«racija</h3>
        <p>NorÄ—dami naudoti realÅ³ reÅ¾imÄ…, redaguokite <code>.env</code> failÄ…:</p>
        <ul>
            <li><strong>SUNO_API_KEY</strong> - Gauti iÅ¡ <a href="https://api.sunoapi.org" target="_blank">api.sunoapi.org</a></li>
            <li><strong>GEMINI_API_KEY</strong> - Gauti iÅ¡ <a href="https://makersuite.google.com/app/apikey" target="_blank">Google AI Studio</a></li>
            <li><strong>ğŸŒ Nano-Banana Image Generation</strong> - Naudoja jÅ«sÅ³ GEMINI_API_KEY</li>
        </ul>
        {% endif %}
        
        <h3>ğŸµ Proceso Etapai</h3>
        <ol>
            <li><strong>KÅ«rybinÄ—s idÄ—jos generavimas</strong> - AI sugeneruoja temÄ… ir tekstÄ…</li>
            <li><strong>Muzikos generavimas</strong> - Suno API sukuria audio failus</li>
            <li><strong>VirÅ¡elio kÅ«rimas</strong> - AI sugeneruoja albumo virÅ¡elÄ¯</li>
            <li><strong>FailÅ³ organizavimas</strong> - Visi failai iÅ¡saugomi struktÅ«rizuotai</li>
        </ol>
    </div>
</div>
{% endblock %}